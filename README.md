# ChatApp test

- –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ - web
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è - –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º - –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º–æ: Bloc | Cubit

### –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–≤–µ—Ä—Å—Ç–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ —Å–æ–≥–ª–∞—Å–Ω–æ [–º–∞–∫–µ—Ç—É](https://www.figma.com/file/4IrGXBaFr9eKJljG0Rkttp/Chat-Cut?node-id=0%3A1&t=PDV0TTHFSaH5Eolx-1)

- –†–∞–∑–º–µ—Ç–∏—Ç—å –º–µ—Å—Ç–æ –ø–æ–¥ —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤, –Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –ø—É—Å—Ç—ã–º, –ª–∏–±–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–º.
- –í –æ–∫–Ω–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–∫–æ–µ-—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–µ–∫—Å—Ç, –ø–æ–∂–µ–ª–∞–Ω–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è). 
- –í –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã –¥–æ–ª–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π —Ç–µ–∫—Å—Ç), —Ç–∏–ø (–≤—Ö–æ–¥—è—â–µ–µ –∏–ª–∏ –∏—Å—Ö–æ–¥—è—â–µ–µ) —Ç–∞–∫ –∂–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è —Ç–∞–∫ –∂–µ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ, —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π üòé

- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ js —Å–ª–æ–µ, —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–¥–∞—á–µ–π –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤ dart
- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

### –ß–∞—Å—Ç—å 1

> –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ - web

> –ü—É–±–ª–∏–∫–∞—Ü–∏—è - –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞

–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:\
https://remakerich.github.io/chatapp_test/

> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º - –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º–æ: Bloc | Cubit

–í —Ñ–∞–π–ª–µ `chat_cubit.dart` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å –ø–æ–º–æ—â—å—é Cubit.

### –ß–∞—Å—Ç—å 2

>  –†–∞–∑–º–µ—Ç–∏—Ç—å –º–µ—Å—Ç–æ –ø–æ–¥ —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤, –Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –ø—É—Å—Ç—ã–º, –ª–∏–±–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–º.

–í —Ñ–∞–π–ª–µ `home_screen.dart` –¥–æ–±–∞–≤–ª–µ–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è —Å–ø–∏—Å–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—É–∂–µ–Ω–∏–∏ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞.

>  –í –æ–∫–Ω–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–∫–æ–µ-—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–µ–∫—Å—Ç, –ø–æ–∂–µ–ª–∞–Ω–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è).

–í —Ñ–∞–π–ª–µ `database.dart` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ë–î –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.

```dart
_addInitialMessages();
```

–†–µ–∞–ª–∏–∑–∞—Ü–∏—é –ë–î —Å–º. –Ω–∏–∂–µ.

>  –í –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã –¥–æ–ª–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π —Ç–µ–∫—Å—Ç), —Ç–∏–ø (–≤—Ö–æ–¥—è—â–µ–µ –∏–ª–∏ –∏—Å—Ö–æ–¥—è—â–µ–µ)

–í —Ñ–∞–π–ª–µ `chat_cubit.dart` –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã:

```dart
StreamSubscription<Message>? _chatSubscription;
```

>  –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è —Ç–∞–∫ –∂–µ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å.

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ.

### –ß–∞—Å—Ç—å 3

> –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ js —Å–ª–æ–µ, —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–¥–∞—á–µ–π –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤ dart

–í —Ñ–∞–π–ª–µ `message_generator.js` —Å–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ `chat_repository.dart` —Å –ø–æ–º–æ—â—å—é –ø–∞–∫–µ—Ç–∞ dart:js:

```dart
final message = js.context.callMethod('getRandomMessage');
```

–ú–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã –∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —Ä–∞–Ω–¥–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ Stream.

> –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

–î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø–∞–∫–µ—Ç drift. –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è web –±—ã–ª –≤–∑—è—Ç —Å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –≥–∏—Ç—Ö–∞–±–∞ drift](https://github.com/simolus3/drift/tree/develop/examples/flutter_web_worker_example).

–í —Ñ–∞–π–ª–µ `chat_cubit.dart` –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–∑ –ë–î –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:

```dart
final result = await _chatStorage.getChat();
```

–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–∞ —Ç–∞–∫ –∂–µ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ) –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞–ø–∏—Å—å –≤ –ë–î:

```dart
await _chatStorage.saveMessage(message);
```